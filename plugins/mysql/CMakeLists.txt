FIND_PATH(LIBMYSQL_INCLUDE_DIRS NAMES "mysql.h" PATH_SUFFIXES "mysql" "libmysql")
FIND_LIBRARY(LIBMYSQL_LIBRARIES NAMES "mysqlclient" PATH_SUFFIXES "mysqlclient" "libmysqlclient")
GET_FILENAME_COMPONENT(LIBMYSQL_LIBRARY_DIRS ${LIBMYSQL_LIBRARIES} PATH)

IF(NOT LIBMYSQL_INCLUDE_DIRS OR NOT LIBMYSQL_LIBRARY_DIRS)
    MESSAGE(FATAL_ERROR "MySQL development files are required.")
ENDIF()

INCLUDE_DIRECTORIES(${LIBMYSQL_INCLUDE_DIRS})
LINK_DIRECTORIES(${LIBMYSQL_LIBRARY_DIRS})

ADD_LIBRARY(yappi-plugin-mysql MODULE
    mysql.cpp)

TARGET_LINK_LIBRARIES(yappi-plugin-mysql
    crypto
    mysqlclient
    uriparser)

INSTALL(TARGETS yappi-plugin-mysql
    LIBRARY DESTINATION lib/yappi
    COMPONENT runtime)
